spec_version: 2
description: "EKS cluster deployment blueprint"

inputs:
  region:
    type: string
    default: us-east-1
    description: "AWS region for deployment"
  cluster_name:
    type: string
    default: yana-eks-demo
    description: "Name of the EKS cluster"
  vpc_id:
    type: string
    default: vpc-066d43cb6f15cce6e
    description: "VPC ID where cluster will be deployed"
  subnet_ids:
    type: string
    default: "subnet-04b1589da0f453bf0,subnet-0bf18a6dd31e1ced8,subnet-0f1d5a7ff8ffaef40,subnet-0b7d40186a55da75e,subnet-027ce9c0f9e5c9a07"
    description: "Comma-separated list of subnet IDs"
  agent:
    type: string
    default: "torqueagent02"
    description: "Torque execution agent to use"

outputs:
  cluster_endpoint:
    value: '{{ .grains.eks_cluster.outputs.cluster_endpoint }}'
    kind: string
    quick: true
  cluster_name:
    value: '{{ .grains.eks_cluster.outputs.cluster_name }}'
    kind: string
    quick: true

grains:
  eks_cluster:
    kind: terraform
    spec:
      source:
        store: Quali_Torque_Assignment_EKS_
        path: .
      agent:
        name: torqueagent02
      inputs:
        - region: '{{ .inputs.region }}'
        - cluster_name: '{{ .inputs.cluster_name }}'
        - vpc_id: '{{ .inputs.vpc_id }}'
        - subnet_ids: '{{ .inputs.subnet_ids }}'
